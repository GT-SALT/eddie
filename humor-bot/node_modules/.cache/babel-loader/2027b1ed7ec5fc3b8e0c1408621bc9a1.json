{"ast":null,"code":"var _jsxFileName = \"/home/anishthite/Workspace/humor-bot/humor-bot/src/App.js\";\nimport React from 'react';\nimport './App.css';\nimport PropTypes from 'prop-types';\nimport ChatBot, { Loading } from 'react-simple-chatbot';\nimport axios from 'axios';\nimport https from 'https';\nimport Button from '@material-ui/core/Button';\nconst URL = \"https://greetez.com:4240/predict\";\nconst feedbackURL = \"https://greetez.com:4240/feedback\";\nconst myURL = \"https://pal-ai.github.io/chat\";\nprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\n\nconst uuidv4 = require('uuid/v4');\n\nconst myuuid = uuidv4();\nvar IDLE_TIMEOUT = 30; //seconds\n\nvar _idleSecondsCounter = 0;\nvar interval;\n\nwindow.onkeydown = function () {\n  _idleSecondsCounter = 0;\n};\n\nwindow.onkeyup = function () {\n  _idleSecondsCounter = 0;\n};\n\nwindow.onkeypress = function () {\n  _idleSecondsCounter = 0;\n};\n\nwindow.oninput = function () {\n  _idleSecondsCounter = 0;\n};\n\nvar history = [];\nvar start = ['What are you doing today?', 'What are you doing right now?', 'What\\'s up?', 'How are you today?', 'What do you like to do?', 'How are you?'];\n\nclass FeedbackButton extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      size: \"small\",\n      color: \"default\",\n      onClick: () => {\n        window.clearInterval(interval);\n        this.props.triggerNextStep({\n          value: 'yes',\n          trigger: 'feedback-form'\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 7\n      }\n    }, \"Wrong Response? Click Me!\");\n  }\n\n}\n\nclass NewTopic extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      result: /*#__PURE__*/React.createElement(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52,\n          columnNumber: 27\n        }\n      })\n    };\n    this.state.result = this.getRandomStart();\n    this.props.triggerNextStep();\n  }\n\n  getRandomInt(max) {\n    return Math.floor(Math.random() * Math.floor(max));\n  }\n\n  getRandomStart() {\n    const message = start[this.getRandomInt(start.length)];\n    history[history.length - 1] = history[history.length - 1] + ' ' + message; //console.log('message');\n\n    return message;\n  }\n\n  render() {\n    return this.state.result;\n  }\n\n}\n\nclass Thanks extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loading: true,\n      result: /*#__PURE__*/React.createElement(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 42\n        }\n      }),\n      trigger: false\n    };\n    this.state.result = '';\n    this.searchInputTimeout = setTimeout(() => {\n      this.sendfeedback(props).then(myresponse => {\n        console.log(myresponse);\n        this.refresh();\n      });\n    }, 400);\n  }\n\n  render() {\n    return this.state.result;\n  }\n\n  sendfeedback(props) {\n    var tosend = {\n      \"history\": history,\n      \"id\": myuuid,\n      'feedback': props.steps['user-feedback']['message']\n    };\n    const instance = axios.create({\n      httpsAgent: new https.Agent({\n        rejectUnauthorized: false,\n        strictSSL: false\n      })\n    });\n    return instance.post(feedbackURL, tosend).then(function (response) {\n      console.log(response.data);\n      return response.data;\n    }).catch(err => console.log(err));\n  }\n\n  refresh() {\n    window.location.replace(myURL);\n  }\n\n}\n\nclass Interfacer extends React.Component {\n  constructor(props) {\n    super(props);\n    this.stopTimer();\n    this.CheckIdleTime = this.CheckIdleTime.bind(this);\n    this.state = {\n      loading: true,\n      result: /*#__PURE__*/React.createElement(Loading, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 42\n        }\n      }),\n      trigger: false,\n      trigfunc: this.props.triggerNextStep\n    };\n    history.push(props.previousStep.message);\n    this.searchInputTimeout = setTimeout(() => {\n      this.makeprediction().then(myresponse => {\n        this.state.result = myresponse;\n        history.push(myresponse);\n        this.startTimer();\n        this.props.triggerNextStep();\n      });\n    }, 400);\n  }\n\n  makeprediction() {\n    var tosend = {\n      \"history\": history.slice(-(2 * 10 + 1)),\n      \"device\": \"cpu\",\n      \"top_p\": 0.0,\n      \"top_k\": 10,\n      \"temperature\": 1,\n      \"id\": myuuid\n    };\n    const instance = axios.create({\n      httpsAgent: new https.Agent({\n        rejectUnauthorized: false,\n        strictSSL: false\n      })\n    });\n    return instance.post(URL, tosend).then(function (response) {\n      return response.data;\n    }).catch(err => console.log(err));\n  }\n\n  render() {\n    return this.state.result;\n  }\n\n  startTimer() {\n    interval = window.setInterval(this.CheckIdleTime, 1000);\n  }\n\n  stopTimer() {\n    window.clearInterval(interval);\n  }\n\n  CheckIdleTime() {\n    _idleSecondsCounter++; //console.log(_idleSecondsCounter)\n\n    if (_idleSecondsCounter >= IDLE_TIMEOUT) {\n      this.props.triggerNextStep({\n        value: 'yes',\n        trigger: 'start1'\n      });\n      _idleSecondsCounter = 0;\n    }\n  }\n\n}\n\nInterfacer.propTypes = {\n  previousStep: PropTypes.object,\n  triggerNextStep: PropTypes.func\n};\nInterfacer.defaultProps = {\n  steps: undefined,\n  triggerNextStep: undefined\n};\nvar steps = [{\n  id: 'start0',\n  message: 'Hello there!',\n  trigger: 'user'\n}, {\n  id: 'start1',\n  component: /*#__PURE__*/React.createElement(NewTopic, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 16\n    }\n  }),\n  asMessage: true,\n  waitAction: true,\n  trigger: 'user'\n}, {\n  id: 'user',\n  user: true,\n  trigger: 'message-returner'\n}, {\n  id: 'message-returner',\n  component: /*#__PURE__*/React.createElement(Interfacer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 16\n    }\n  }),\n  trigger: 'feedback',\n  waitAction: true,\n  asMessage: true\n}, {\n  id: 'feedback',\n  component: /*#__PURE__*/React.createElement(FeedbackButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 16\n    }\n  }),\n  asMessage: true,\n  trigger: 'user'\n}, {\n  id: 'feedback-form',\n  message: 'What should have I said?',\n  trigger: 'user-feedback'\n}, {\n  id: 'user-feedback',\n  user: true,\n  trigger: 'thanks-message'\n}, {\n  id: 'thanks-message',\n  delay: 1500,\n  message: 'Thanks!',\n  trigger: 'thanks'\n}, {\n  id: 'thanks',\n  component: /*#__PURE__*/React.createElement(Thanks, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 16\n    }\n  }),\n  asMessage: true,\n  delay: 100\n}];\n\nfunction App() {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"App\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ChatBot, {\n    width: \"100%\",\n    enableMobileAutoFocus: \"true\",\n    steps: steps,\n    headerTitle: \"PAL\",\n    contentStyle: {\n      height: '86vh'\n    },\n    style: {\n      height: '100%'\n    },\n    botDelay: 0,\n    userDelay: 50,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }\n  })));\n}\n\nexport default App;","map":{"version":3,"sources":["/home/anishthite/Workspace/humor-bot/humor-bot/src/App.js"],"names":["React","PropTypes","ChatBot","Loading","axios","https","Button","URL","feedbackURL","myURL","process","env","NODE_TLS_REJECT_UNAUTHORIZED","uuidv4","require","myuuid","IDLE_TIMEOUT","_idleSecondsCounter","interval","window","onkeydown","onkeyup","onkeypress","oninput","history","start","FeedbackButton","Component","constructor","props","render","clearInterval","triggerNextStep","value","trigger","NewTopic","state","result","getRandomStart","getRandomInt","max","Math","floor","random","message","length","Thanks","loading","searchInputTimeout","setTimeout","sendfeedback","then","myresponse","console","log","refresh","tosend","steps","instance","create","httpsAgent","Agent","rejectUnauthorized","strictSSL","post","response","data","catch","err","location","replace","Interfacer","stopTimer","CheckIdleTime","bind","trigfunc","push","previousStep","makeprediction","startTimer","slice","setInterval","propTypes","object","func","defaultProps","undefined","id","component","asMessage","waitAction","user","delay","App","height"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './App.css';\nimport PropTypes from 'prop-types';\nimport ChatBot, { Loading } from 'react-simple-chatbot';\nimport axios from 'axios'\nimport https from 'https'\nimport Button from '@material-ui/core/Button';\n\n\nconst URL = \"https://greetez.com:4240/predict\"\nconst feedbackURL = \"https://greetez.com:4240/feedback\"\nconst myURL = \"https://pal-ai.github.io/chat\"\nprocess.env.NODE_TLS_REJECT_UNAUTHORIZED = '0';\nconst uuidv4 = require('uuid/v4');\nconst myuuid = uuidv4();\n\nvar IDLE_TIMEOUT = 30; //seconds\nvar _idleSecondsCounter = 0;\nvar interval;\nwindow.onkeydown = function() {\n  _idleSecondsCounter = 0;\n};\nwindow.onkeyup = function() {\n  _idleSecondsCounter = 0;\n};\nwindow.onkeypress = function() {\n  _idleSecondsCounter = 0;\n};\nwindow.oninput = function() {\n  _idleSecondsCounter = 0;\n};\n\nvar history = [];\nvar start = ['What are you doing today?', 'What are you doing right now?', 'What\\'s up?', 'How are you today?', 'What do you like to do?', 'How are you?']\n\nclass FeedbackButton extends React.Component {\n  constructor(props) {\n    super(props)\n  }\n  render() {\n    return (\n      <Button variant=\"contained\" size=\"small\" color=\"default\" onClick={() => { \n        window.clearInterval(interval); this.props.triggerNextStep({value : 'yes', trigger: 'feedback-form'});\n      }}>Wrong Response? Click Me!</Button>\n    );\n  }\n}\n\nclass NewTopic extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {result: <Loading />};\n    this.state.result = this.getRandomStart();\n    this.props.triggerNextStep();\n  }\n  getRandomInt(max) {\n    return Math.floor(Math.random() * Math.floor(max));\n  }\n  getRandomStart(){\n    const message = start[this.getRandomInt(start.length)];\n    history[history.length -1] = history[history.length -1] + ' ' + message;\n    //console.log('message');\n    return(message);\n  }\n  render() {\n    return(this.state.result)\n  }\n}\n\nclass Thanks extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {loading: true, result: <Loading />, trigger: false};\n    this.state.result = '';\n    this.searchInputTimeout = setTimeout(() => {this.sendfeedback(props).then(\n      myresponse => {\n        console.log(myresponse);\n        this.refresh();\n      });\n  }, 400);\n  }\n  render() {\n    return (this.state.result);\n  }\n\n  sendfeedback(props) {\n    var tosend = {\n      \"history\" : history,\n      \"id\" : myuuid,\n      'feedback' :props.steps['user-feedback']['message']\n    }\n    const instance = axios.create({\n      httpsAgent: new https.Agent({  \n        rejectUnauthorized: false,\n        strictSSL: false\n      })\n    });\n\n    return instance.post(feedbackURL,tosend)\n    .then(function(response) {\n      console.log(response.data);\n      return response.data;\n    })\n    .catch(err=>console.log(err))\n  }\n  refresh() {\n    window.location.replace(myURL);\n  }\n}\n\nclass Interfacer extends React.Component{\n  constructor(props) {\n    super(props);\n    this.stopTimer();\n    this.CheckIdleTime=this.CheckIdleTime.bind(this);\n    this.state = {loading: true, result: <Loading />, trigger: false, trigfunc: this.props.triggerNextStep};\n    history.push(props.previousStep.message);\n    this.searchInputTimeout = setTimeout(() => {this.makeprediction().then(\n      myresponse => {\n      this.state.result = myresponse;\n      history.push(myresponse);\n      this.startTimer();\n      this.props.triggerNextStep();\n    });\n  }, 400);\n  }\n\n  makeprediction(){\n    var tosend = {\n      \"history\" : history.slice(-(2*10+1)),\n      \"device\" : \"cpu\",\n      \"top_p\" : 0.0,\n      \"top_k\" : 10,\n      \"temperature\" : 1,\n      \"id\" : myuuid\n    }\n    const instance = axios.create({\n      httpsAgent: new https.Agent({  \n        rejectUnauthorized: false,\n        strictSSL: false\n      })\n    });\n\n    return instance.post(URL,tosend)\n    .then(function(response) {\n      return response.data;\n    })\n    .catch(err=>console.log(err))\n  }\n\n  render() {\n    return(this.state.result);\n  }\nstartTimer() {\n  interval = window.setInterval(this.CheckIdleTime, 1000);\n}\n\nstopTimer() {\n  window.clearInterval(interval);\n}\nCheckIdleTime() {\n    _idleSecondsCounter++;\n    //console.log(_idleSecondsCounter)\n    if (_idleSecondsCounter >= IDLE_TIMEOUT) {\n      this.props.triggerNextStep({value : 'yes', trigger: 'start1'});\n      _idleSecondsCounter = 0;\n    }\n}\n}\n\n\nInterfacer.propTypes = {\n  previousStep: PropTypes.object,\n  triggerNextStep: PropTypes.func,\n};\n\nInterfacer.defaultProps = {\n  steps: undefined,\n  triggerNextStep: undefined,\n};\n\nvar steps = [\n  {\n    id: 'start0',\n    message: 'Hello there!',\n    trigger: 'user',\n  },\n  {\n    id: 'start1',\n    component: <NewTopic />,\n    asMessage: true,\n    waitAction: true,\n    trigger: 'user',\n  },\n  {\n    id: 'user',\n    user: true,\n    trigger: 'message-returner',\n  },\n  {\n    id: 'message-returner',\n    component: <Interfacer />,\n    trigger: 'feedback',\n    waitAction: true,\n    asMessage: true\n  },\n  {\n    id: 'feedback',\n    component: <FeedbackButton />,\n    asMessage: true,\n    trigger: 'user'\n  },\n  {\n    id: 'feedback-form',\n    message: 'What should have I said?',\n    trigger: 'user-feedback'\n  },\n  {\n    id: 'user-feedback',\n    user: true,\n    trigger: 'thanks-message'\n  },\n  {\n    id: 'thanks-message',\n    delay: 1500,\n    message: 'Thanks!',\n    trigger: 'thanks'\n  },\n  {\n    id: 'thanks',\n    component: <Thanks />,\n    asMessage: true,\n    delay: 100\n  }\n];\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <div>\n      <ChatBot width=\"100%\" enableMobileAutoFocus='true' steps={steps} headerTitle=\"PAL\" contentStyle={{ height: '86vh' }} style={{ height: '100%' }} botDelay={0} userDelay={50} />\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n\n"]},"metadata":{},"sourceType":"module"}